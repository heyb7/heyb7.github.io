<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Shell脚本语法 - heyb7&#39;s blog</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="heyb7" />
  <meta name="description" content="一、显示消息 使用 echo 命令来显示消息 1 2 3 4 5 $ echo This is a test This is a test $ echo &amp;#34;Let&amp;#39;s see if this&amp;#39;ll work&amp;#34; Let&amp;#39;s see if this&amp;#39;ll work echo 输出不换行 echo 命令的 -n 参数表示输出文本字符后不换行 1 2" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.59.1" />


<link rel="canonical" href="https://heyb7.github.io/post/shell%E8%84%9A%E6%9C%AC%E8%AF%AD%E6%B3%95/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="Shell脚本语法" />
<meta property="og:description" content="一、显示消息 使用 echo 命令来显示消息 1 2 3 4 5 $ echo This is a test This is a test $ echo &#34;Let&#39;s see if this&#39;ll work&#34; Let&#39;s see if this&#39;ll work echo 输出不换行 echo 命令的 -n 参数表示输出文本字符后不换行 1 2" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://heyb7.github.io/post/shell%E8%84%9A%E6%9C%AC%E8%AF%AD%E6%B3%95/" />
<meta property="article:published_time" content="2019-10-16T17:48:52+08:00" />
<meta property="article:modified_time" content="2019-10-16T17:48:52+08:00" />
<meta itemprop="name" content="Shell脚本语法">
<meta itemprop="description" content="一、显示消息 使用 echo 命令来显示消息 1 2 3 4 5 $ echo This is a test This is a test $ echo &#34;Let&#39;s see if this&#39;ll work&#34; Let&#39;s see if this&#39;ll work echo 输出不换行 echo 命令的 -n 参数表示输出文本字符后不换行 1 2">


<meta itemprop="datePublished" content="2019-10-16T17:48:52&#43;08:00" />
<meta itemprop="dateModified" content="2019-10-16T17:48:52&#43;08:00" />
<meta itemprop="wordCount" content="9136">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Shell脚本语法"/>
<meta name="twitter:description" content="一、显示消息 使用 echo 命令来显示消息 1 2 3 4 5 $ echo This is a test This is a test $ echo &#34;Let&#39;s see if this&#39;ll work&#34; Let&#39;s see if this&#39;ll work echo 输出不换行 echo 命令的 -n 参数表示输出文本字符后不换行 1 2"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">heyb7</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://heyb7.github.io/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://heyb7.github.io/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://heyb7.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://heyb7.github.io/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://gohugo.io" rel="noopener" target="_blank">
              外部链接
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      heyb7
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://heyb7.github.io/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://heyb7.github.io/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://heyb7.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://heyb7.github.io/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://gohugo.io" rel="noopener" target="_blank">
              外部链接
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Shell脚本语法</h1>
      
      <div class="post-meta">
        <time datetime="2019-10-16" class="post-time">
          2019-10-16
        </time>
        
        <span class="more-meta"> 约 9136 字 </span>
          <span class="more-meta"> 预计阅读 19 分钟 </span>

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#一-显示消息">一、显示消息</a>
<ul>
<li><a href="#使用-echo-命令来显示消息">使用 echo 命令来显示消息</a></li>
<li><a href="#echo-输出不换行">echo 输出不换行</a></li>
<li><a href="#echo-输出特殊转义字符">echo 输出特殊转义字符</a></li>
</ul></li>
<li><a href="#二-变量">二、变量</a>
<ul>
<li><a href="#默认shell环境变量">默认shell环境变量</a></li>
<li><a href="#用户变量">用户变量</a></li>
<li><a href="#访问变量">访问变量</a></li>
<li><a href="#命令替换">命令替换</a></li>
</ul></li>
<li><a href="#三-输出和输入重定向">三、输出和输入重定向</a>
<ul>
<li><a href="#输出重定向">输出重定向</a></li>
<li><a href="#输入重定向">输入重定向</a></li>
</ul></li>
<li><a href="#四-数学运算">四、数学运算</a>
<ul>
<li><a href="#expr命令">expr命令</a></li>
<li><a href="#使用方括号">使用方括号</a></li>
<li><a href="#浮点数运算">浮点数运算</a></li>
</ul></li>
<li><a href="#五-if-语句">五、if 语句</a>
<ul>
<li><a href="#if-then-语句">if-then 语句</a></li>
<li><a href="#if-then-else-语句">if-then-else 语句</a></li>
<li><a href="#test-命令">test 命令</a>
<ul>
<li><a href="#数值比较">数值比较</a></li>
<li><a href="#字符串比较">字符串比较</a></li>
<li><a href="#文件比较">文件比较</a></li>
</ul></li>
<li><a href="#复合条件测试">复合条件测试</a></li>
<li><a href="#if-then-的高级特性">if-then 的高级特性</a>
<ul>
<li><a href="#使用双括号">使用双括号</a></li>
<li><a href="#使用双方括号">使用双方括号</a></li>
</ul></li>
</ul></li>
<li><a href="#六-case语句">六、case语句</a></li>
<li><a href="#七-for语句">七、for语句</a>
<ul>
<li><a href="#字段分隔符">字段分隔符</a></li>
<li><a href="#c-语言风格的-for-命令">C 语言风格的 for 命令</a></li>
</ul></li>
<li><a href="#八-while语句">八、while语句</a>
<ul>
<li><a href="#控制循环">控制循环</a>
<ul>
<li><a href="#break-命令">break 命令</a></li>
<li><a href="#continue-命令">continue 命令</a></li>
</ul></li>
</ul></li>
<li><a href="#九-命令行参数和特殊参数变量">九、命令行参数和特殊参数变量</a></li>
<li><a href="#十-获得用户输入">十、获得用户输入</a></li>
<li><a href="#十一-重定向">十一、重定向</a></li>
<li><a href="#十二-函数">十二、函数</a></li>
<li><a href="#十三-sed编辑器">十三、sed编辑器</a>
<ul>
<li><a href="#sed命令">sed命令</a></li>
<li><a href="#替换命令">替换命令</a></li>
<li><a href="#使用行寻址">使用行寻址</a></li>
<li><a href="#删除命令">删除命令</a></li>
<li><a href="#插入和追加命令">插入和追加命令</a></li>
<li><a href="#修改行">修改行</a></li>
<li><a href="#转换命令">转换命令</a></li>
</ul></li>
<li><a href="#十四-awk程序">十四、awk程序</a>
<ul>
<li><a href="#文本数据字段变量">文本数据字段变量</a></li>
<li><a href="#在程序脚本中使用多个命令">在程序脚本中使用多个命令</a></li>
<li><a href="#从文件中读取程序">从文件中读取程序</a></li>
<li><a href="#处理数据前要执行的语句">处理数据前要执行的语句</a></li>
<li><a href="#处理数据后要执行的语句">处理数据后要执行的语句</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h1 id="一-显示消息">一、显示消息</h1>

<h2 id="使用-echo-命令来显示消息">使用 echo 命令来显示消息</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> This is a <span class="nb">test</span>
This is a <span class="nb">test</span>

$ <span class="nb">echo</span> <span class="s2">&#34;Let&#39;s see if this&#39;ll work&#34;</span>
Let<span class="s1">&#39;s see if this&#39;</span>ll work</code></pre></td></tr></table>
</div>
</div>
<h2 id="echo-输出不换行">echo 输出不换行</h2>

<p>echo 命令的 -n 参数表示输出文本字符后不换行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/sh</span>
<span class="nb">echo</span> -n <span class="s2">&#34;The time and date are: &#34;</span>
date

$ ./test.sh
The <span class="nb">time</span> and date are: Thu Oct <span class="m">17</span> <span class="m">11</span>:54:49 CST <span class="m">2019</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="echo-输出特殊转义字符">echo 输出特殊转义字符</h2>

<p>echo 使用 -e 参数来输出特殊的转义字符，特殊的转义字符包括 制表符（\t）、换行符（\n）等。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> -e <span class="s2">&#34;hello\tworld&#34;</span>
hello	world

$ <span class="nb">echo</span> -e <span class="s2">&#34;hello\nworld&#34;</span>
hello
world</code></pre></td></tr></table>
</div>
</div>
<h1 id="二-变量">二、变量</h1>

<h2 id="默认shell环境变量">默认shell环境变量</h2>

<table>
<thead>
<tr>
<th align="center">变量</th>
<th align="center">描述</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">HOME</td>
<td align="center">当前用户的主目录</td>
</tr>

<tr>
<td align="center">IFS</td>
<td align="center">shell用来将文本字符串分割成字段的一系列字符</td>
</tr>

<tr>
<td align="center">PATH</td>
<td align="center">shell查找命令的目录列表,由冒号分隔</td>
</tr>

<tr>
<td align="center">PS1</td>
<td align="center">shell命令行界面的主提示符</td>
</tr>

<tr>
<td align="center">PS2</td>
<td align="center">shell命令行界面的次提示符</td>
</tr>

<tr>
<td align="center">PWD</td>
<td align="center">当前工作目录</td>
</tr>

<tr>
<td align="center">REPLY</td>
<td align="center">read命令的默认变量</td>
</tr>

<tr>
<td align="center">UID</td>
<td align="center">当前用户的真实用户ID(数字形式)</td>
</tr>
</tbody>
</table>

<h2 id="用户变量">用户变量</h2>

<p>等号(=)两边不能有空格</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nv">var1</span><span class="o">=</span><span class="m">10</span>  
<span class="nv">var2</span><span class="o">=</span>-57  
<span class="nv">var3</span><span class="o">=</span>testing  
<span class="nv">var4</span><span class="o">=</span><span class="s2">&#34;still more testing&#34;</span>  </code></pre></td></tr></table>
</div>
</div>
<h2 id="访问变量">访问变量</h2>

<p><strong>变量名前加 $ 符号来访问变量, $var 或者 ${var}</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> <span class="nv">$PATH</span>
/usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin

$ <span class="nb">echo</span> <span class="si">${</span><span class="nv">USER</span><span class="si">}</span>
heyb

$ <span class="nb">echo</span> <span class="nv">$var1</span>
<span class="m">10</span>

$ <span class="nb">echo</span> <span class="si">${</span><span class="nv">var3</span><span class="si">}</span>
testing</code></pre></td></tr></table>
</div>
</div>
<h2 id="命令替换">命令替换</h2>

<p><strong>命令替换是从命令输出中提取信息，然后赋值给变量</strong></p>

<p>有两种方法可以把命令输出赋值给变量，等号（=）两边不能空格</p>

<ol>
<li>反引号字符 (`)</li>
<li>$() 格式</li>
</ol>

<ul>
<li><p>反引号字符 (`) 格式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nv">testing</span><span class="o">=</span><span class="sb">`</span>date<span class="sb">`</span>
$ <span class="nb">echo</span> <span class="nv">$testing</span>
Thu Oct <span class="m">17</span> <span class="m">14</span>:22:35 CST <span class="m">2019</span></code></pre></td></tr></table>
</div>
</div></li>

<li><p>$() 格式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nv">testing</span><span class="o">=</span><span class="k">$(</span>date<span class="k">)</span>
$ <span class="nb">echo</span> <span class="nv">$testing</span>
Thu Oct <span class="m">17</span> <span class="m">14</span>:22:35 CST <span class="m">2019</span></code></pre></td></tr></table>
</div>
</div></li>
</ul>

<h1 id="三-输出和输入重定向">三、输出和输入重定向</h1>

<h2 id="输出重定向">输出重定向</h2>

<p><code>command &gt; outputfile</code></p>

<p>最基本的重定向将命令的输出发送到一个文件中，用大于号（&gt;）来完成该功能。</p>

<p>如果该文件不存在，则新建该文件；如果该文件已经存在，则会覆盖文件的数据。</p>

<p>输出重定向向文件中追加数据用双大于号 ( &gt;&gt; )。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ date &gt; testfile
$ cat testfile
Thu Oct <span class="m">17</span> <span class="m">14</span>:59:19 CST <span class="m">2019</span>

$ who &gt;&gt; testfile
$ cat testfile
Thu Oct <span class="m">17</span> <span class="m">14</span>:59:19 CST <span class="m">2019</span>
heyb     pts/0        <span class="m">2019</span>-10-08 <span class="m">19</span>:43 <span class="o">(</span>:0<span class="o">)</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="输入重定向">输入重定向</h2>

<p><strong>输入重定向将文件的内容重定向到命令，输入重定向符号是小于号 ( &lt; )</strong></p>

<p><code>command &lt; inputfile</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ wc &lt; testfile
<span class="m">2</span> <span class="m">11</span> <span class="m">73</span></code></pre></td></tr></table>
</div>
</div>
<p>wc命令可以对文件中的文本数据进行计数，输出的3个默认值分别表示：文本的行数、文本的词数、文本的字节数</p>

<p><strong>内联输入重定向</strong></p>

<p>内联输入重定向符号是远小于号(&lt;&lt;)。除了这个符号,你必须指定一个标记符号来划分输
入数据的开始和结尾。任何字符串都可作为标记符号,但在数据的开始和结尾标记符号必须一致。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></pre></td>
<td class="lntd">
<pre class="chroma">command &lt;&lt; EOF
data
EOF</pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ wc <span class="s">&lt;&lt; EOF
</span><span class="s">&gt; test string 1
</span><span class="s">&gt; test string 2
</span><span class="s">&gt; test string 3
</span><span class="s">&gt; EOF</span>
<span class="m">3</span> <span class="m">9</span> <span class="m">42</span></code></pre></td></tr></table>
</div>
</div>
<h1 id="四-数学运算">四、数学运算</h1>

<h2 id="expr命令">expr命令</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ expr <span class="m">1</span> + <span class="m">5</span>
<span class="m">6</span>

$ expr <span class="m">5</span> * <span class="m">2</span>
expr: syntax error

$ expr <span class="m">5</span> <span class="se">\*</span> <span class="m">2</span>
<span class="m">10</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="使用方括号">使用方括号</h2>

<p>将一个数学运算结果赋给某个变量时,可以用美元符号和方括号( $[ operation ] )将数学表达式围起来</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nv">var1</span><span class="o">=</span>$<span class="o">[</span><span class="m">1</span> + <span class="m">5</span><span class="o">]</span>
$ <span class="nb">echo</span> <span class="nv">$var1</span>
<span class="m">6</span>

$ <span class="nv">var2</span><span class="o">=</span>$<span class="o">[</span><span class="nv">$var1</span> * <span class="m">2</span><span class="o">]</span>
$ <span class="nb">echo</span> <span class="nv">$var2</span>
<span class="m">12</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="浮点数运算">浮点数运算</h2>

<p>浮点数运算用 bc 命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ bc
bc <span class="m">1</span>.06.95
Copyright <span class="m">1991</span>-1994, <span class="m">1997</span>, <span class="m">1998</span>, <span class="m">2000</span>, <span class="m">2004</span>, <span class="m">2006</span> Free Software Foundation, Inc.
This is free software with ABSOLUTELY NO WARRANTY.
For details <span class="nb">type</span> <span class="sb">`</span>warranty<span class="err">&#39;</span>.
<span class="m">12</span> * <span class="m">5</span>.4
<span class="m">64</span>.8

<span class="m">3</span>.156 * <span class="o">(</span><span class="m">3</span> + <span class="m">5</span><span class="o">)</span>
<span class="m">25</span>.248
quit</code></pre></td></tr></table>
</div>
</div>
<h1 id="五-if-语句">五、if 语句</h1>

<h2 id="if-then-语句">if-then 语句</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> command<span class="p">;</span> <span class="k">then</span>
    commands
<span class="k">fi</span></code></pre></td></tr></table>
</div>
</div>
<p>if 语句会执行 if 后面的那个命令。
如果该命令的退出状态码是 0(该命令成功运行)，if条件成立，位于 then 部分的命令就会被执行。
如果该命令的退出状态码是其他值, 则if条件不成立，then部分的命令就不会被执行。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/sh</span>

<span class="k">if</span> pwd<span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;It worked.&#34;</span>
<span class="k">fi</span>

$ ./test.sh
/home/heyb
It worked</code></pre></td></tr></table>
</div>
</div>
<h2 id="if-then-else-语句">if-then-else 语句</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> command<span class="p">;</span> <span class="k">then</span>
    commands
<span class="k">else</span>
    commands
<span class="k">fi</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/sh</span>

<span class="nv">testuser</span><span class="o">=</span>NoSuchUser

<span class="k">if</span> grep <span class="nv">$testuser</span> /etc/passwd<span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;The bash files for user </span><span class="nv">$testuser</span><span class="s2"> are:&#34;</span>
    ls -a /home/<span class="nv">$testuser</span>/.b*
    <span class="nb">echo</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;The user </span><span class="nv">$testuser</span><span class="s2"> does not exist on this system.&#34;</span>
    <span class="nb">echo</span>
<span class="k">fi</span>

$ ./test.sh
The user NoSuchUser does not exist on this system.</code></pre></td></tr></table>
</div>
</div>
<h2 id="test-命令">test 命令</h2>

<p>test 命令提供了在 if-then 语句中测试不同条件的途径。如果 test 命令中列出的条件成立, test 命令就会退出并返回退出状态码 0 。这样 if-then 语句就与其他编程语言中的 if-then 语句以类似的方式工作了。如果条件不成立, test 命令就会退出并返回非零的退出状态码,这使得 if-then 语句不会再被执行。</p>

<p>test 命令的格式非常简单。</p>

<p><code>test condition</code></p>

<p>当用在 if-then 语句中时, test 命令看起来是这样的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="nb">test</span> condition<span class="p">;</span><span class="k">then</span>
    commands
<span class="k">fi</span></code></pre></td></tr></table>
</div>
</div>
<p>如果不写 test 命令的 condition 部分,它会以非零的退出状态码退出,并执行 else 语句块。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>

<span class="k">if</span> test<span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;No expression returns a True&#34;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;No expression returns a False&#34;</span>
<span class="k">fi</span>

$ ./test.sh
No expression returns a False</code></pre></td></tr></table>
</div>
</div>
<p>bash shell提供了另一种条件测试方法,无需在 if-then 语句中声明 test 命令。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">if</span> <span class="o">[</span> condition <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    commands
<span class="k">fi</span></code></pre></td></tr></table>
</div>
</div>
<p>方括号定义了测试条件。注意,第一个方括号之后和第二个方括号之前必须加上一个空格,否则就会报错。</p>

<p>test 命令可以判断三类条件</p>

<ol>
<li>数值比较</li>
<li>字符串比较</li>
<li>文件比较</li>
</ol>

<h3 id="数值比较">数值比较</h3>

<p><strong>不能在 test 命令中使用浮点值，test 命令只能处理整数</strong></p>

<table>
<thead>
<tr>
<th align="center">比较</th>
<th align="center">描述</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">n1 -eq n2</td>
<td align="center">检查 n1 是否与 n2 相等</td>
</tr>

<tr>
<td align="center">n1 -ge n2</td>
<td align="center">检查 n1 是否大于或等于 n2</td>
</tr>

<tr>
<td align="center">n1 -gt n2</td>
<td align="center">检查 n1 是否大于 n2</td>
</tr>

<tr>
<td align="center">n1 -le n2</td>
<td align="center">检查 n1 是否小于或等于 n2</td>
</tr>

<tr>
<td align="center">n1 -lt n2</td>
<td align="center">检查 n1 是否小于 n2</td>
</tr>

<tr>
<td align="center">n1 -ne n2</td>
<td align="center">检查 n1 是否不等于 n2</td>
</tr>
</tbody>
</table>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>

<span class="nv">value1</span><span class="o">=</span><span class="m">10</span>
<span class="nv">value2</span><span class="o">=</span><span class="m">11</span>

<span class="k">if</span> <span class="o">[</span> <span class="nv">$value1</span> -gt <span class="m">5</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;The test value
</span><span class="s2">fi
</span><span class="s2">
</span><span class="s2">if [ </span><span class="nv">$value1</span><span class="s2"> -eq </span><span class="nv">$value2</span><span class="s2"> ]
</span><span class="s2">then
</span><span class="s2">    echo &#34;</span>The values are
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;The values are
</span><span class="s2">fi
</span><span class="s2">
</span><span class="s2"></span>$<span class="s2"> ./test.sh
</span><span class="s2">The test value 10 is greater than 5
</span><span class="s2">The values are different</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="字符串比较">字符串比较</h3>

<table>
<thead>
<tr>
<th align="center">比较</th>
<th align="center">描述</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">str1 = str2</td>
<td align="center">检查 str1 是否和 str2 相同</td>
</tr>

<tr>
<td align="center">str1 != str2</td>
<td align="center">检查 str1 是否和 str2 不同</td>
</tr>

<tr>
<td align="center">str1 &lt; str2</td>
<td align="center">检查 str1 是否比 str2 小</td>
</tr>

<tr>
<td align="center">str1 &gt; str2</td>
<td align="center">检查 str1 是否比 str2 大</td>
</tr>

<tr>
<td align="center">-n str1</td>
<td align="center">检查 str1 的长度是否非0</td>
</tr>

<tr>
<td align="center">-z str1</td>
<td align="center">检查 str1 的长度是否为0</td>
</tr>
</tbody>
</table>

<p><strong>在测试条件中使用大于或小于功能时，大于号和小于号必须转义，否则shell会把他们当作重定向符号</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># testing string equality</span>

<span class="nv">testuser</span><span class="o">=</span>heyb
#
<span class="k">if</span> <span class="o">[</span> <span class="nv">$USER</span> <span class="o">=</span> <span class="nv">$testuser</span> <span class="o">]</span>
<span class="k">then</span>
<span class="nb">echo</span> <span class="s2">&#34;Welcome </span><span class="nv">$testuser</span><span class="s2">&#34;</span>
<span class="k">fi</span>

$ ./test.sh
Welcome heyb</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># mis-using string comparisons</span>

<span class="nv">val1</span><span class="o">=</span>baseball
<span class="nv">val2</span><span class="o">=</span>hockey

<span class="k">if</span> <span class="o">[</span> <span class="nv">$val1</span> <span class="se">\&gt;</span> <span class="nv">$val2</span> <span class="o">]</span>
<span class="k">then</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$val1</span><span class="s2"> is greater than </span><span class="nv">$val2</span><span class="s2">&#34;</span>
<span class="k">else</span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$val1</span><span class="s2"> is less than </span><span class="nv">$val2</span><span class="s2">&#34;</span>
<span class="k">fi</span>

$ ./test.sh
baseball is less than hockey</code></pre></td></tr></table>
</div>
</div>
<h3 id="文件比较">文件比较</h3>

<table>
<thead>
<tr>
<th align="center">比较</th>
<th align="center">描述</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">-d file</td>
<td align="center">检查 file 是否存在并是一个目录</td>
</tr>

<tr>
<td align="center">-e file</td>
<td align="center">检查 file 是否存在</td>
</tr>

<tr>
<td align="center">-f file</td>
<td align="center">检查 file 是否存在并是一个文件</td>
</tr>

<tr>
<td align="center">-r file</td>
<td align="center">检查 file 是否存在并可读</td>
</tr>

<tr>
<td align="center">-s file</td>
<td align="center">检查 file 是否存在并非空</td>
</tr>

<tr>
<td align="center">-w file</td>
<td align="center">检查 file 是否存在并可写</td>
</tr>

<tr>
<td align="center">-x file</td>
<td align="center">检查 file 是否存在并可执行</td>
</tr>

<tr>
<td align="center">-O file</td>
<td align="center">检查 file 是否存在并属当前用户所有</td>
</tr>

<tr>
<td align="center">-G file</td>
<td align="center">检查 file 是否存在并且默认组与当前用户相同</td>
</tr>

<tr>
<td align="center">file1 -nt file2</td>
<td align="center">检查 file1 是否比 file2 新</td>
</tr>

<tr>
<td align="center">file1 -ot file2</td>
<td align="center">检查 file1 是否比 file2 旧</td>
</tr>
</tbody>
</table>

<h2 id="复合条件测试">复合条件测试</h2>

<p>if-then 语句允许你使用布尔逻辑来组合测试，有两种布尔运算符可用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span> condition1 <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> condition2 <span class="o">]</span>
<span class="o">[</span> condition1 <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> condition2 <span class="o">]</span></code></pre></td></tr></table>
</div>
</div>
<p>第一种布尔运算使用 AND 布尔运算符来组合两个条件。要让 then 部分的命令执行,两个条件都必须满足</p>

<p>第二种布尔运算使用 OR 布尔运算符来组合两个条件。如果任意条件为 TRUE , then 部分的命令就会执行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># testing compound comparisons</span>

<span class="k">if</span> <span class="o">[</span> -d <span class="nv">$HOME</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="o">[</span> -w <span class="nv">$HOME</span>/testing <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;The file exists and you can write to it&#34;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;I cannot write to the file&#34;</span>
<span class="k">fi</span>

$ ./test.sh
I cannot write to the file

$ touch <span class="nv">$HOME</span>/testing

$ ./test.sh
The file exists and you can write to it</code></pre></td></tr></table>
</div>
</div>
<h2 id="if-then-的高级特性">if-then 的高级特性</h2>

<p>bash shell提供了两项可在 if-then 语句中使用的高级特性:</p>

<ol>
<li>用于数学表达式的双括号 (( ))</li>
<li>用于高级字符串处理功能的双方括号 [[ ]]</li>
</ol>

<h3 id="使用双括号">使用双括号</h3>

<p>双括号命令允许你在比较过程中使用高级数学表达式。 test 命令只能在比较中使用简单的算术操作，双括号命令提供了更多的数学符号</p>

<p>双括号命令的格式如下:</p>

<p><code>(( expression ))</code></p>

<table>
<thead>
<tr>
<th align="center">符号</th>
<th align="center">描述</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">val++</td>
<td align="center">后增</td>
</tr>

<tr>
<td align="center">val&ndash;</td>
<td align="center">后减</td>
</tr>

<tr>
<td align="center">++val</td>
<td align="center">先增</td>
</tr>

<tr>
<td align="center">&ndash;val</td>
<td align="center">先减</td>
</tr>

<tr>
<td align="center">!</td>
<td align="center">逻辑求反</td>
</tr>

<tr>
<td align="center">~</td>
<td align="center">位求反</td>
</tr>

<tr>
<td align="center">**</td>
<td align="center">幂运算</td>
</tr>

<tr>
<td align="center">&lt;&lt;</td>
<td align="center">左位移</td>
</tr>

<tr>
<td align="center">&gt;&gt;</td>
<td align="center">右位移</td>
</tr>

<tr>
<td align="center">&amp;</td>
<td align="center">位布尔和</td>
</tr>

<tr>
<td align="center">|</td>
<td align="center">位布尔或</td>
</tr>

<tr>
<td align="center">&amp;&amp;</td>
<td align="center">逻辑和</td>
</tr>

<tr>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># using double parenthesis</span>

<span class="nv">val1</span><span class="o">=</span><span class="m">10</span>

<span class="k">if</span> <span class="o">((</span> <span class="nv">$val1</span> ** <span class="m">2</span> &gt; <span class="m">90</span> <span class="o">))</span>
<span class="k">then</span>
    <span class="o">((</span> <span class="nv">val2</span> <span class="o">=</span> <span class="nv">$val1</span> ** <span class="m">2</span> <span class="o">))</span>
    <span class="nb">echo</span> <span class="s2">&#34;The square of </span><span class="nv">$val1</span><span class="s2"> is </span><span class="nv">$val2</span><span class="s2">&#34;</span>
<span class="k">fi</span>

$ ./test.sh
The square of <span class="m">10</span> is <span class="m">100</span></code></pre></td></tr></table>
</div>
</div>
<p>可以在 if 语句中用双括号命令，也可以在脚本中的普通命令里使用来赋值</p>

<p>不需要将双括号中表达式里的大于号转义，这是双括号命令提供的另一个高级特性</p>

<h3 id="使用双方括号">使用双方括号</h3>

<p>双方括号命令提供了针对字符串比较的高级特性，双方括号命令的格式如下：</p>

<p><code>[[ expression ]]</code></p>

<p>双方括号里的 expression 使用了 test 命令中采用的标准字符串比较。但它提供了 test 命令未提供的另一个特性——模式匹配(pattern matching)。</p>

<p>在模式匹配中,可以定义一个正则表达式来匹配字符串值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># using pattern matching</span>

<span class="k">if</span> <span class="o">[[</span> <span class="nv">$USER</span> <span class="o">==</span> h* <span class="o">]]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;Hello </span><span class="nv">$USER</span><span class="s2">&#34;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&#34;Sorry, I do not know you&#34;</span>
<span class="k">fi</span>

$ ./test.sh
Hello heyb</code></pre></td></tr></table>
</div>
</div>
<p>在上面的脚本中,我们使用了双等号( == )。双等号将右边的字符串( r* )视为一个模式,并应用模式匹配规则。双方括号命令 $USER 环境变量进行匹配,看它是否以字母 h 开头。如果是的话,比较通过,shell会执行 then 部分的命令。</p>

<h1 id="六-case语句">六、case语句</h1>

<p>case语句的格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">case</span> variable in
    pattern1 <span class="p">|</span> pattern2<span class="o">)</span>
        commands1
    <span class="p">;;</span>
    pattern3<span class="o">)</span> 
        commands2
    <span class="p">;;</span>
    *<span class="o">)</span> default 
        commands
    <span class="p">;;</span>
<span class="k">esac</span></code></pre></td></tr></table>
</div>
</div>
<p>case 语句示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># using the case command</span>

<span class="k">case</span> <span class="nv">$USER</span> in
    heyb <span class="p">|</span> barbara<span class="o">)</span>
        <span class="nb">echo</span> <span class="s2">&#34;Welcome, </span><span class="nv">$USER</span><span class="s2">&#34;</span>
        <span class="nb">echo</span> <span class="s2">&#34;Please enjoy your visit&#34;</span>
    <span class="p">;;</span>
    testing<span class="o">)</span>
        <span class="nb">echo</span> <span class="s2">&#34;Special testing account&#34;</span>
        <span class="p">;;</span>
    jessica<span class="o">)</span>
        <span class="nb">echo</span> <span class="s2">&#34;Do not forget to log off when you&#39;re done&#34;</span>
    <span class="p">;;</span>
    *<span class="o">)</span>
        <span class="nb">echo</span> <span class="s2">&#34;Sorry, you are not allowed here&#34;</span>
    <span class="p">;;</span>
<span class="k">esac</span>

$ ./test.sh
Welcome, heyb
Please enjoy your visit</code></pre></td></tr></table>
</div>
</div>
<h1 id="七-for语句">七、for语句</h1>

<p>for语句的基本格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">for</span> var in list
<span class="k">do</span>
    commands
<span class="k">done</span></code></pre></td></tr></table>
</div>
</div>
<p>list提供迭代需要的一系列值。</p>

<p>第一次迭代会使用list中的第一个值,第二次迭代使用第二个值,以此类推,直到列表中的所有值都过一遍。</p>

<p>for语句中list列表的值可以通过以下几种方式获取：</p>

<ul>
<li><p>直接指定list中的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># basic for command</span>
<span class="k">for</span> <span class="nb">test</span> in Alabama Alaska Arizona Arkansas California Colorado
<span class="k">do</span>
<span class="nb">echo</span> The next state is <span class="nv">$test</span>
<span class="k">done</span>

$ ./test.sh
The next state is Alabama
The next state is Alaska
The next state is Arizona
The next state is Arkansas
The next state is California
The next state is Colorado</code></pre></td></tr></table>
</div>
</div></li>

<li><p>从变量中读取list的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># using a variable to hold the list 13</span>
<span class="nv">list</span><span class="o">=</span><span class="s2">&#34;Alabama Alaska Arizona Arkansas Colorado&#34;</span>
<span class="nv">list</span><span class="o">=</span><span class="nv">$list</span><span class="s2">&#34; Connecticut&#34;</span>

<span class="k">for</span> state in <span class="nv">$list</span>
<span class="k">do</span>
<span class="nb">echo</span> <span class="s2">&#34;Have you ever visited </span><span class="nv">$state</span><span class="s2">?&#34;</span>
<span class="k">done</span>

$ ./test.sh
Have you ever visited Alabama?
Have you ever visited Alaska?
Have you ever visited Arizona?
Have you ever visited Arkansas?
Have you ever visited Colorado?
Have you ever visited Connecticut?</code></pre></td></tr></table>
</div>
</div></li>
</ul>

<p>$list 变量包含了用于迭代的标准文本值列表。注意,代码还是用了另一个赋值语句向 $list变量包含的已有列表中添加(或者说是拼接)了一个值。这是向变量中存储的已有文本字符串尾部添加文本的一个常用方法。</p>

<ul>
<li><p>从命令读取</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># reading values from a file</span>

<span class="nv">file</span><span class="o">=</span><span class="s2">&#34;states&#34;</span>
<span class="k">for</span> state in <span class="k">$(</span>cat <span class="nv">$file</span><span class="k">)</span>
<span class="k">do</span>
<span class="nb">echo</span> <span class="s2">&#34;Visit beautiful </span><span class="nv">$state</span><span class="s2">&#34;</span>
<span class="k">done</span>

$ cat states
Alabama
Alaska
Arizona
Arkansas
Colorado
Connecticut
Delaware
Florida
Georgia

$ ./test.sh
Visit beautiful Alabama
Visit beautiful Alaska
Visit beautiful Arizona
Visit beautiful Arkansas
Visit beautiful Colorado
Visit beautiful Connecticut
Visit beautiful Delaware
Visit beautiful Florida
Visit beautiful Georgia</code></pre></td></tr></table>
</div>
</div></li>
</ul>

<h2 id="字段分隔符">字段分隔符</h2>

<p>bash shell有一个特殊的环境变量 IFS ,叫作内部字段分隔符(internal field separator)。</p>

<p>IFS 环境变量定义了bash shell用作字段分隔符的一系列字符。默认情况下,bash shell会将下列字符当作字段分隔符:
1. 空格
2. 制表符
3. 换行符</p>

<p>IFS 的值设置为换行符：</p>

<p><code>IFS=$'\n'</code></p>

<p>IFS 的值设为冒号：</p>

<p><code>IFS=:</code></p>

<p>IFS 的值设为多个字符：</p>

<p><code>IFS=$'\n':;&quot;</code></p>

<p>这个赋值会将换行符（\n）、冒号（:）、分号（;）和双引号（&rdquo;）作为字段分隔符</p>

<ul>
<li><p>用通配符读取目录作为list的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># iterate through all the files in a directory</span>

<span class="k">for</span> file in /home/heyb/test/*
<span class="k">do</span>
<span class="k">if</span> <span class="o">[</span> -d <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2"> is a directory&#34;</span>
<span class="k">elif</span> <span class="o">[</span> -f <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2">&#34;</span> <span class="o">]</span>
<span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$file</span><span class="s2"> is a file&#34;</span>
<span class="k">fi</span>
<span class="k">done</span>

$ ./test.sh
/home/rich/heyb/dir1 is a directory
/home/rich/heyb/myprog.c is a file
/home/rich/heyb/myprog is a file
/home/rich/heyb/myscript is a file
/home/rich/heyb/newdir is a directory
/home/rich/heyb/newfile is a file
/home/rich/heyb/newfile2 is a file
/home/rich/heyb/testdir is a directory
/home/rich/heyb/testing is a file
/home/rich/heyb/testprog is a file
/home/rich/heyb/testprog.c is a file</code></pre></td></tr></table>
</div>
</div></li>
</ul>

<h2 id="c-语言风格的-for-命令">C 语言风格的 for 命令</h2>

<p>bash shell中C语言风格的 for 循环的基本格式：</p>

<p><code>for (( variable assignment ; condition ; iteration process ))</code></p>

<p><code>for (( a = 1; a &lt; 10; a++ ))</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># testing the C-style for loop</span>

<span class="k">for</span> <span class="o">((</span> <span class="nv">i</span><span class="o">=</span><span class="m">1</span><span class="p">;</span> i &lt;<span class="o">=</span> <span class="m">10</span><span class="p">;</span> i++ <span class="o">))</span>
<span class="k">do</span>
    <span class="nb">echo</span> <span class="s2">&#34;The next number is </span><span class="nv">$i</span><span class="s2">&#34;</span>
<span class="k">done</span>

$ ./test.sh
The next number is <span class="m">1</span>
The next number is <span class="m">2</span>
The next number is <span class="m">3</span>
The next number is <span class="m">4</span>
The next number is <span class="m">5</span>
The next number is <span class="m">6</span>
The next number is <span class="m">7</span>
The next number is <span class="m">8</span>
The next number is <span class="m">9</span>
The next number is <span class="m">10</span></code></pre></td></tr></table>
</div>
</div>
<h1 id="八-while语句">八、while语句</h1>

<p>while 的基本格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">while</span> <span class="nb">test</span> <span class="nb">command</span>
<span class="k">do</span>
    other commands
<span class="k">done</span></code></pre></td></tr></table>
</div>
</div>
<p>最常见的 test command 的用法是用方括号来检查循环命令中用到的shell变量的值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># while command test</span>

<span class="nv">var1</span><span class="o">=</span><span class="m">10</span>

<span class="k">while</span> <span class="o">[</span> <span class="nv">$var1</span> -gt <span class="m">0</span> <span class="o">]</span>
<span class="k">do</span>
    <span class="nb">echo</span> <span class="nv">$var1</span>
    <span class="nv">var1</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$var1</span> - <span class="m">1</span> <span class="o">]</span>
<span class="k">done</span>

$ ./test.sh
<span class="m">10</span>
<span class="m">9</span>
<span class="m">8</span>
<span class="m">7</span>
<span class="m">6</span>
<span class="m">5</span>
<span class="m">4</span>
<span class="m">3</span>
<span class="m">2</span>
<span class="m">1</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="控制循环">控制循环</h2>

<h3 id="break-命令">break 命令</h3>

<p>break 跳出当前循环</p>

<h3 id="continue-命令">continue 命令</h3>

<p>continue 命令可以提前中止某次循环，但并不会完全终止整个循环</p>

<h1 id="九-命令行参数和特殊参数变量">九、命令行参数和特殊参数变量</h1>

<p>位置参数变量是标准的数字: $0 是程序名, $1 是第一个参数, $2 是第二个参数,依次类推,直到第九个参数 $9</p>

<p>在第9个变量之后，必须在变量数字周围加上花括号，比如 ${10}表示第十个参数</p>

<p><strong>basename 命令返回不包含路径的脚本名</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ basename /home/heyb/test/test.sh
test.sh</code></pre></td></tr></table>
</div>
</div>
<table>
<thead>
<tr>
<th align="center">参数名</th>
<th align="center">含义</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">$0</td>
<td align="center">脚本程序名</td>
</tr>

<tr>
<td align="center">$1 ~ $9</td>
<td align="center">第一个命令行参数 ~ 第九个命令行参数</td>
</tr>

<tr>
<td align="center">${10}</td>
<td align="center">第十个命令行参数</td>
</tr>

<tr>
<td align="center">$?</td>
<td align="center">命令执行的返回值，成功返回0，失败返回非零值</td>
</tr>

<tr>
<td align="center">$#</td>
<td align="center">命令行参数的个数，不包括程序名</td>
</tr>

<tr>
<td align="center">$*</td>
<td align="center">将命令行上提供的所有参数当作一个单词保存，将所有参数当成单个参数</td>
</tr>

<tr>
<td align="center">$@</td>
<td align="center">将命令行上提供的所有参数当作同一字符串中的多个独立的单词，单独处理每个参数</td>
</tr>
</tbody>
</table>

<p><strong>移动变量</strong></p>

<p>shift 命令会根据参数相对位置来移动命令行参数
shift 向左边依次移动命令行参数，移出去的参数的值将被丢弃，不能恢复</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># demonstrating the shift command</span>

<span class="nb">echo</span>
<span class="nv">count</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span> <span class="o">[</span> -n <span class="s2">&#34;</span><span class="nv">$1</span><span class="s2">&#34;</span> <span class="o">]</span>
<span class="k">do</span>
    <span class="nb">echo</span> <span class="s2">&#34;Parameter #</span><span class="nv">$count</span><span class="s2"> = </span><span class="nv">$1</span><span class="s2">&#34;</span>
    <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span> <span class="o">]</span>
    <span class="nb">shift</span>
<span class="k">done</span>

$ ./test.sh rich barbara katie jessica
Parameter <span class="c1">#1 = rich</span>
Parameter <span class="c1">#2 = barbara</span>
Parameter <span class="c1">#3 = katie</span>
Parameter <span class="c1">#4 = jessica</span></code></pre></td></tr></table>
</div>
</div>
<h1 id="十-获得用户输入">十、获得用户输入</h1>

<p><strong>read 命令获取用户输入</strong></p>

<p>read 命令从标准输入(键盘)或另一个文件描述符中接受输入。在收到输入后, read 命令会将数据放进一个变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># testing the read command</span>

<span class="nb">echo</span> -n <span class="s2">&#34;Enter your name: &#34;</span>
<span class="nb">read</span> name
<span class="nb">echo</span> <span class="s2">&#34;Hello </span><span class="nv">$name</span><span class="s2">, welcome to my program. &#34;</span>

$ ./test.sh
Enter your name: heyb
Hello heyb, welcome to my program.</code></pre></td></tr></table>
</div>
</div>
<p>read 命令包含 -p 选项,允许直接在 read 命令行指定提示符</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">read</span> -p <span class="s2">&#34;Please enter your age: &#34;</span> age
Please enter your age: <span class="m">10</span></code></pre></td></tr></table>
</div>
</div>
<p><strong>用 read 命令来读取文件中保存的数据</strong></p>

<p>每次调用 read 命令,它都会从文件中读取一行文本。当文件中没有内容时, read 命令会退出并返回非零退出状态码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># reading data from a file</span>

<span class="nv">count</span><span class="o">=</span><span class="m">1</span>
cat <span class="nb">test</span> <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> line
<span class="k">do</span>
    <span class="nb">echo</span> <span class="s2">&#34;Line </span><span class="nv">$count</span><span class="s2">: </span><span class="nv">$line</span><span class="s2">&#34;</span>
    <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span><span class="o">]</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&#34;Finished processing the file&#34;</span>

$ cat <span class="nb">test</span>
The quick brown dog jumps over the lazy fox.
This is a test, this is only a test.
O Romeo, Romeo! Wherefore art thou Romeo?

$ ./test.sh
Line <span class="m">1</span>: The quick brown dog jumps over the lazy fox.
Line <span class="m">2</span>: This is a test, this is only a test.
Line <span class="m">3</span>: O Romeo, Romeo! Wherefore art thou Romeo?
Finished processing the file
$</code></pre></td></tr></table>
</div>
</div>
<p><strong>从文件中读取数据，一种比较常见的写法是利用输入重定向来实现：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># reading data from a file</span>

<span class="nv">count</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span> <span class="nb">read</span> line
<span class="k">do</span>
    <span class="nb">echo</span> <span class="s2">&#34;Line </span><span class="nv">$count</span><span class="s2">: </span><span class="nv">$line</span><span class="s2">&#34;</span>
    <span class="nv">count</span><span class="o">=</span>$<span class="o">[</span> <span class="nv">$count</span> + <span class="m">1</span><span class="o">]</span>
<span class="k">done</span> &lt; <span class="nb">test</span>
<span class="nb">echo</span> <span class="s2">&#34;Finished processing the file&#34;</span>

$ cat <span class="nb">test</span>
The quick brown dog jumps over the lazy fox.
This is a test, this is only a test.
O Romeo, Romeo! Wherefore art thou Romeo?

$ ./test.sh
Line <span class="m">1</span>: The quick brown dog jumps over the lazy fox.
Line <span class="m">2</span>: This is a test, this is only a test.
Line <span class="m">3</span>: O Romeo, Romeo! Wherefore art thou Romeo?
Finished processing the file</code></pre></td></tr></table>
</div>
</div>
<h1 id="十一-重定向">十一、重定向</h1>

<table>
<thead>
<tr>
<th align="center">符号</th>
<th align="center">含义</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">&gt;</td>
<td align="center">输出重定向</td>
</tr>

<tr>
<td align="center">2&gt;</td>
<td align="center">错误重定向</td>
</tr>

<tr>
<td align="center">&amp;&gt;</td>
<td align="center">错误数据和标准输出同时重定向到一个文件中</td>
</tr>

<tr>
<td align="center">&gt;&amp;2</td>
<td align="center">把输出重定向到错误输出，主要用来人为生成错误消息</td>
</tr>
</tbody>
</table>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># testing STDERR messages</span>

<span class="nb">echo</span> <span class="s2">&#34;This is an error&#34;</span> &gt;<span class="p">&amp;</span><span class="m">2</span>
<span class="nb">echo</span> <span class="s2">&#34;This is normal output&#34;</span>

$ ./test.sh <span class="m">2</span>&gt; <span class="nb">test</span>
This is normal output

$ cat test9
This is an error</code></pre></td></tr></table>
</div>
</div>
<h1 id="十二-函数">十二、函数</h1>

<p><strong>创建函数</strong></p>

<p>bash shell中有2种风格的格式来创建函数：</p>

<ol>
<li><p>采用关键字 function，后跟函数名  （<strong>function 和 函数名之间要有空格</strong>）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="k">function</span> name <span class="o">{</span>  
commands  
<span class="o">}</span>  </code></pre></td></tr></table>
</div>
</div></li>

<li><p>在函数名的后面加上空括号，表明定义的是一个函数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">name<span class="o">()</span> <span class="o">{</span>  
commands  
<span class="o">}</span>  </code></pre></td></tr></table>
</div>
</div></li>
</ol>

<p><strong>函数调用</strong></p>

<p>调用函数只要指定函数名就可以了</p>

<p>函数定义必须在函数调用之前</p>

<p><strong>函数返回值</strong></p>

<p>默认情况下,函数的退出状态码是函数中最后一条命令返回的退出状态码。在函数执行结束后,可以用标准变量 $? 来确定函数的退出状态码</p>

<p>也可以通过return来给函数返回一个返回值</p>

<p>函数的返回值也可以赋值给一个变量</p>

<p><code>ret=$(fun_name)</code></p>

<p>这个命令会将 fun_name 函数的输出赋给 result 变量，然后通过 ${ret} 来获取函数的返回值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/sh</span>

<span class="k">function</span> func_test <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">&#34;This is function test...&#34;</span>

    <span class="k">return</span> <span class="m">2</span>
<span class="o">}</span>

func_test

<span class="nb">echo</span> <span class="s2">&#34;The return value is &#34;</span> <span class="nv">$?</span>

$ ./test.sh
This is <span class="k">function</span> test...
The <span class="k">return</span> value is  <span class="m">2</span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/bash</span>
<span class="c1"># using the echo to return a value</span>

<span class="k">function</span> func_test <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">&#34;100&#34;</span>
<span class="o">}</span>

<span class="nv">result</span><span class="o">=</span><span class="k">$(</span>func_test<span class="k">)</span>                    
<span class="nb">echo</span> <span class="s2">&#34;the result is </span><span class="nv">$result</span><span class="s2">&#34;</span>

$ ./test.sh
the result is <span class="m">100</span></code></pre></td></tr></table>
</div>
</div>
<hr />

<p><strong>向函数传递参数</strong></p>

<p>函数可以使用标准的参数环境变量来表示命令行上传给函数的参数。例如,函数名会在 $0 变量中定义,
函数命令行上的任何参数都会通过 $1、$2 等定义。也可以用特殊变量 $# 来判断传给函数的参数数目</p>

<p>在脚本中调用函数时,必须将参数和函数放在同一行,像这样:</p>

<p><code>test_fun param1 param2</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat test.sh
<span class="c1">#!/bin/sh</span>

<span class="k">function</span> test_fun <span class="o">{</span>
    <span class="nb">echo</span> <span class="s2">&#34;function params test...&#34;</span>

    <span class="nb">echo</span> <span class="s2">&#34;first param is &#34;</span> <span class="nv">$1</span>
    <span class="nb">echo</span> <span class="s2">&#34;second param is &#34;</span> <span class="nv">$2</span>
<span class="o">}</span>

test_fun hello world

$ ./test.sh hello world
<span class="k">function</span> params test...
first param is  hello
second param is  world</code></pre></td></tr></table>
</div>
</div>
<p><strong>在函数中处理变量</strong></p>

<p>函数使用两种类型的变量:</p>

<ol>
<li>全局变量</li>
<li>局部变量</li>
</ol>

<p>全局变量是在shell脚本中任何地方都有效的变量。
如果你在脚本的主体部分定义了一个全局变量,那么可以在函数内读取它的值。
类似地,如果你在函数内定义了一个全局变量,可以在脚本的主体部分读取它的值。</p>

<p>不需要在函数中使用全局变量时,函数内部使用的任何变量都可以被声明成局部变量。要实现这
一点,只要在变量声明的前面加上 local 关键字就可以了</p>

<p><code>local temp</code></p>

<h1 id="十三-sed编辑器">十三、sed编辑器</h1>

<p>sed编辑器被叫做流式编辑器。</p>

<p>sed编辑器可以根据命令来处理数据流中的数据,这些命令要么从命令行中输入,要么存储在一个命令文本文件中</p>

<p>sed编辑器执行流程如下：</p>

<ol>
<li>一次从输入中读取一行数据</li>
<li>根据所提供的编辑器命令匹配数据</li>
<li>按照命令修改流中的数据</li>
<li>将新的数据输出到 STDOUT</li>
</ol>

<p>sed命令的基本语法:</p>

<p><code>sed [option] commands [commands-file]</code></p>

<p>sed命令选项：</p>

<table>
<thead>
<tr>
<th align="center">选项</th>
<th align="center">说明</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">-e commands</td>
<td align="center">在处理数据时，执行 commands 指定的一条或多条命令</td>
</tr>

<tr>
<td align="center">-f commands-file</td>
<td align="center">在处理数据时，从 commands-file 的命令文件中读取命令</td>
</tr>

<tr>
<td align="center">-n</td>
<td align="center">在处理数据时，不产生输出</td>
</tr>
</tbody>
</table>

<p><strong>在命令行使用sed编辑器命令</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> <span class="s2">&#34;This is a test&#34;</span> <span class="p">|</span> sed <span class="s1">&#39;s/test/big test/&#39;</span>
this is a big test</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>

$ sed <span class="s1">&#39;s/test/big test/&#39;</span> data.txt
this is a big <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a big test</code></pre></td></tr></table>
</div>
</div>
<p><strong>在命令行使用多个sed编辑器命令</strong></p>

<p>两个命令之间必须用分号隔开,并且在命令末尾和分号之间不能有空格</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>

$ sed -e <span class="s1">&#39;s/a/two/; s/test/big test/&#39;</span> data.txt
this is two big <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is two big test</code></pre></td></tr></table>
</div>
</div>
<p><strong>从文件中读取sed编辑器命令</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat commands.sed 
s/a/two/
s/test/big test/

$ sed -f commands.sed data.txt 
this is two big <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is two big test</code></pre></td></tr></table>
</div>
</div>
<p>commands.sed命令文件中的每条命令后面不用放分号，sed编辑器知道每行都是一条单独的命令</p>

<h2 id="sed命令">sed命令</h2>

<table>
<thead>
<tr>
<th align="center">命令</th>
<th align="center">说明</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">s</td>
<td align="center">替换</td>
</tr>

<tr>
<td align="center">d</td>
<td align="center">删除</td>
</tr>

<tr>
<td align="center">i</td>
<td align="center">插入</td>
</tr>

<tr>
<td align="center">a</td>
<td align="center">追加</td>
</tr>

<tr>
<td align="center">c</td>
<td align="center">修改</td>
</tr>

<tr>
<td align="center">y</td>
<td align="center">转换</td>
</tr>
</tbody>
</table>

<h2 id="替换命令">替换命令</h2>

<p>替换命令用 s 来表示，替换命令的格式如下：</p>

<p><strong>s/a/b/</strong>   数据中的 a 将被 b 替换</p>

<p><strong>替换标记</strong></p>

<p>替换标记在替换命令字符串之后设置</p>

<p><strong>s/pattern/replacement/flags</strong></p>

<p>有4种可用的替换标记:</p>

<ol>
<li>数字，表明新文本将替换第几处模式匹配的地方;</li>
<li>g ，表明新文本将会替换所有匹配的文本;</li>
<li>p ，表明原先行的内容要打印出来;</li>
<li>w file ，将替换的结果写到文件中</li>
</ol>

<p><strong>数字替换标记</strong>可以指定sed编辑器替换第几处模式匹配的地方</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
This is a <span class="nb">test</span> of the <span class="nb">test</span> script.
This is the second <span class="nb">test</span> of the <span class="nb">test</span> script.

$ sed <span class="s1">&#39;s/test/trial/2&#39;</span> data.txt
This is a <span class="nb">test</span> of the trial script.
This is the second <span class="nb">test</span> of the trial script.</code></pre></td></tr></table>
</div>
</div>
<p>替换标记指定为 2 的结果就是:sed编辑器只替换每行中第二次出现的匹配模式</p>

<p><strong>g 替换标记</strong>可以替换文本中匹配模式所匹配到的每个地方</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
This is a <span class="nb">test</span> of the <span class="nb">test</span> script.
This is the second <span class="nb">test</span> of the <span class="nb">test</span> script.

$ sed <span class="s1">&#39;s/test/trial/g&#39;</span> data.txt
This is a trial of the trial script.
This is the second trial of the trial script.</code></pre></td></tr></table>
</div>
</div>
<p><strong>p 替换标记</strong>会打印替换命令中指定的模式匹配的行。这通常会和 sed 的 -n 选项一起使用。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
This is a <span class="nb">test</span> line.
This is a different line.

$ sed -n <span class="s1">&#39;s/test/trial/p&#39;</span> data.txt
This is a trial line.</code></pre></td></tr></table>
</div>
</div>
<p>-n 选项将禁止sed编辑器输出。但 p 替换标记会输出修改过的行。将二者配合使用的效果就是只输出被替换命令修改过的行</p>

<p><strong>w 替换标记</strong>会产生同样的输出,不过会将输出保存到指定文件中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
This is a <span class="nb">test</span> line.
This is a different line.

$ sed <span class="s1">&#39;s/test/trial/w test.txt&#39;</span> data.txt
This is a trial line.
This is a different line.

$ cat test.txt
This is a trial line.</code></pre></td></tr></table>
</div>
</div>
<p><strong>替换特殊字符</strong>
替换特殊字符需要使用反斜线转义字符 ()</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ sed <span class="s1">&#39;s/\/bin\/bash/\/bin\/sh/&#39;</span> /etc/passwd</code></pre></td></tr></table>
</div>
</div>
<p>sed编辑器允许使用其他字符来作为替换命令中的字符串分隔符:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ sed <span class="s1">&#39;s!/bin/bash!/bin/csh!&#39;</span> /etc/passwd</code></pre></td></tr></table>
</div>
</div>
<p>在这个例子中,感叹号被用作字符串分隔符</p>

<h2 id="使用行寻址">使用行寻址</h2>

<p>默认情况下,在sed编辑器中使用的命令会作用于文本数据的所有行。如果只想将命令作用于特定行或某些行,则必须用行寻址</p>

<p>在sed编辑器中有两种形式的行寻址:</p>

<ol>
<li>以数字形式表示行区间</li>
<li>用文本模式来过滤出指定的行</li>
</ol>

<p>两种形式都使用相同的格式来指定行地址:</p>

<p><code>[address] command</code></p>

<p>也可以将特定地址的多个命令分组:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">address <span class="o">{</span>
    command1
    command2
    command3
<span class="o">}</span></code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>数字方式的行寻址</strong></li>
</ul>

<p>在命令中指定的行地址可以是单个行号，也可以是用起始行号、逗号以及结尾行号指定的一定区间范围内的行</p>

<p>sed编辑器只修改第二行的数据。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>

$ sed <span class="s1">&#39;2s/test/big test/&#39;</span> data.txt
this is a <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a test</code></pre></td></tr></table>
</div>
</div>
<p>只修改第二行和第三行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ sed <span class="s1">&#39;2,3s/test/big test/&#39;</span> data.txt
this is a <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a test</code></pre></td></tr></table>
</div>
</div>
<p>修改从第二行开始的所有行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ sed <span class="s1">&#39;2,$s/test/big test/&#39;</span> data.txt
this is a <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a big <span class="nb">test</span>
this is a big test</code></pre></td></tr></table>
</div>
</div>
<ul>
<li><strong>使用文本模式过滤器来进行行寻址</strong></li>
</ul>

<p>格式如下:</p>

<p><code>/pattern/command</code></p>

<p>必须用正斜线将要指定的 pattern 封起来。sed编辑器会将该命令作用到包含指定文本模式的行上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ grep Samantha /etc/passwd
Samantha❌502:502::/home/Samantha:/bin/bash

$ sed <span class="s1">&#39;/Samantha/s/bash/csh/&#39;</span> /etc/passwd
root❌0:0:root:/root:/bin/bash
bin❌1:1:bin:/bin:/sbin/nologin
<span class="o">[</span>...<span class="o">]</span>
Christine❌501:501:Christine B:/home/Christine:/bin/bash
Samantha❌502:502::/home/Samantha:/bin/csh
Timothy❌503:503::/home/Timothy:/bin/bash</code></pre></td></tr></table>
</div>
</div>
<ul>
<li><p><strong>使用组合命令</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ sed <span class="s1">&#39;2{
</span><span class="s1">&gt; s/a/two/
</span><span class="s1">&gt; s/test/big test/
</span><span class="s1">&gt; }&#39;</span> data.txt
this is a <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a <span class="nb">test</span>

$ sed <span class="s1">&#39;2,3{
</span><span class="s1">&gt; s/a/two/
</span><span class="s1">&gt; s/test/big test/
</span><span class="s1">&gt; }&#39;</span> data.txt
this is a <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is two big <span class="nb">test</span>
this is a <span class="nb">test</span>
this is a test</code></pre></td></tr></table>
</div>
</div></li>
</ul>

<h2 id="删除命令">删除命令</h2>

<p>删除命令使用 d ， 它会删除匹配模式匹配到的所有行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
This is line number <span class="m">1</span>.
This is line number <span class="m">2</span>.
This is line number <span class="m">3</span>.
This is line number <span class="m">4</span>.

$ sed <span class="s1">&#39;3d&#39;</span> data.txt
This is line number <span class="m">1</span>.
This is line number <span class="m">2</span>.
This is line number <span class="m">4</span>.

$ sed <span class="s1">&#39;3,$d&#39;</span> data.txt
This is line number <span class="m">1</span>.
This is line number <span class="m">2</span>.</code></pre></td></tr></table>
</div>
</div>
<h2 id="插入和追加命令">插入和追加命令</h2>

<ol>
<li>插入( insert )命令( i )会在指定行前增加一个新行;</li>
<li>附加( append )命令( a )会在指定行后增加一个新行。</li>
</ol>

<p>格式如下：</p>

<p>sed &lsquo;[address] command\new-line&rsquo;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> <span class="s2">&#34;test line 2&#34;</span> <span class="p">|</span> sed <span class="s1">&#39;i\test line 1&#39;</span>
<span class="nb">test</span> line <span class="m">1</span>
<span class="nb">test</span> line <span class="m">2</span>

$ <span class="nb">echo</span> <span class="s2">&#34;test line 2&#34;</span> <span class="p">|</span> sed <span class="s1">&#39;a\test line 1&#39;</span>
<span class="nb">test</span> line <span class="m">2</span>
<span class="nb">test</span> line <span class="m">1</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="修改行">修改行</h2>

<p>修改( change )命令使用 c， 它允许修改数据流中整行文本的内容</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
this is line <span class="m">1</span>.
this is line <span class="m">2</span>.
this is line <span class="m">3</span>.
this is line <span class="m">4</span>.

$ sed <span class="s1">&#39;2c\this is chang line.&#39;</span> data.txt
this is line <span class="m">1</span>.
this is change line.
this is line <span class="m">3</span>.
this is line <span class="m">4</span>.</code></pre></td></tr></table>
</div>
</div>
<h2 id="转换命令">转换命令</h2>

<p>转换( transform )命令( y )是唯一可以处理单个字符的sed编辑器命令</p>

<p>转换命令格式如下：</p>

<p>[address]y/inchars/outchars/</p>

<p>转换命令会对 inchars 和 outchars 值进行一对一的映射。 inchars 中的第一个字符会被转换为 outchars 中的第一个字符,第二个字符会被转换成 outchars 中的第二个字符。这个映射过程会一直持续到处理完指定字符。如果 inchars 和 outchars 的长度不同,则sed编辑器会产生一条错误消息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
this is line <span class="m">1</span>.
this is line <span class="m">2</span>.
this is line <span class="m">3</span>.
this is line <span class="m">4</span>.

$ sed <span class="s1">&#39;y/123/789/&#39;</span> data.txt
this is line <span class="m">7</span>.
this is line <span class="m">8</span>.
this is line <span class="m">9</span>.
this is line <span class="m">4</span>.</code></pre></td></tr></table>
</div>
</div>
<h1 id="十四-awk程序">十四、awk程序</h1>

<p>awk程序脚本用一对花括号来定义，必须将脚本命令放到两个花括号 { } 中，还必须把带花括号的命令放在单引号中</p>

<p>awk命令格式：</p>

<p><code>awk option '{commands}' data-file</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
this is line <span class="m">1</span>.
this is line <span class="m">2</span>.
this is line <span class="m">3</span>.
this is line <span class="m">4</span>.

$ awk <span class="s1">&#39;{print &#34;hello world!&#34;}&#39;</span> data.txt 
hello world!
hello world!
hello world!
hello world!</code></pre></td></tr></table>
</div>
</div>
<h2 id="文本数据字段变量">文本数据字段变量</h2>

<p>awk会自动给一行中的每个数据元素分配一个变量，默认情况下，awk会将如下变量分配给它在文本行中发现的数据字段</p>

<ul>
<li>$0 代表整个文本行;</li>
<li>$1 代表文本行中的第1个数据字段;</li>
<li>$2 代表文本行中的第2个数据字段;</li>
<li>$n 代表文本行中的第n个数据字段。</li>
</ul>

<p>在文本行中,每个数据字段都是通过字段分隔符划分的。awk在读取一行文本时，会用预定义的字段分隔符划分每个数据字段。 awk中默认的字段分隔符是任意的空白字符(例如空格或制表符)。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
one line of <span class="nb">test</span> text.
two line of <span class="nb">test</span> text.
three line of <span class="nb">test</span> text.

$ awk <span class="s1">&#39;{print $1}&#39;</span> data.txt
one
two
three</code></pre></td></tr></table>
</div>
</div>
<p>如果你要读取采用了其他字段分隔符的文件,可以用 -F 选项指定字段分割符</p>

<p>下面例子指定冒号 （：）作为分割符来读取 /etc/passwd 文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ awk -F: <span class="s1">&#39;{print $1}&#39;</span> /etc/passwd
root
bin
daemon
adm
lp
sync
shutdown
halt
mail
operator
games
ftp
nobody
<span class="o">[</span>...<span class="o">]</span></code></pre></td></tr></table>
</div>
</div>
<h2 id="在程序脚本中使用多个命令">在程序脚本中使用多个命令</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ <span class="nb">echo</span> <span class="s2">&#34;My name is Rich&#34;</span> <span class="p">|</span> gawk <span class="s1">&#39;{$4=&#34;Christine&#34;; print $0}&#39;</span>
My name is Christine</code></pre></td></tr></table>
</div>
</div>
<h2 id="从文件中读取程序">从文件中读取程序</h2>

<p>把awk程序保存到 commands.awk 文件中，然后 awk 命令从文件中读取程序</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat commands.awk
<span class="o">{</span>print <span class="nv">$1</span> <span class="s2">&#34;&#39;s home directory is &#34;</span> <span class="nv">$6</span><span class="o">}</span>

$ awk -F: -f commands.awk /etc/passwd
root<span class="s1">&#39;s home directory is /root
</span><span class="s1">bin&#39;</span>s home directory is /bin
daemon<span class="s1">&#39;s home directory is /sbin
</span><span class="s1">adm&#39;</span>s home directory is /var/adm
lp<span class="s1">&#39;s home directory is /var/spool/lpd
</span><span class="s1">sync&#39;</span>s home directory is /sbin
shutdown<span class="s1">&#39;s home directory is /sbin
</span><span class="s1">halt&#39;</span>s home directory is /sbin
mail<span class="s1">&#39;s home directory is /var/spool/mail
</span><span class="s1">[...]
</span><span class="s1">heyb&#39;</span>s home directory is /home/heyb</code></pre></td></tr></table>
</div>
</div>
<h2 id="处理数据前要执行的语句">处理数据前要执行的语句</h2>

<p><code>BEGIN</code> 关键字用来指定awk程序在处理数据前要执行的语句</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
line <span class="m">1</span>.
line <span class="m">2</span>.
line <span class="m">3</span>.

$ awk <span class="s1">&#39;BEGIN {print &#34;data.txt file contents:&#34;} {print $0}&#39;</span> data.txt
data.txt file contents:
line <span class="m">1</span>.
line <span class="m">2</span>.
line <span class="m">3</span>.</code></pre></td></tr></table>
</div>
</div>
<h2 id="处理数据后要执行的语句">处理数据后要执行的语句</h2>

<p><code>END</code> 关键字用来指定awk程序在处理数据后要执行的语句</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">$ cat data.txt
line <span class="m">1</span>.
line <span class="m">2</span>.
line <span class="m">3</span>.

$ awk <span class="s1">&#39;BEGIN {print &#34;data.txt file contents:&#34;} {print $0} END {print &#34;end of file&#34;}&#39;</span> data.txt
data.txt file contents:
line <span class="m">1</span>.
line <span class="m">2</span>.
line <span class="m">3</span>.
end of file</code></pre></td></tr></table>
</div>
</div>
    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">heyb7</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2019-10-16
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/%E5%AD%97%E7%AC%A6%E7%BB%88%E7%AB%AF%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">字符终端设置代理</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/markdown%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95/">
            <span class="next-text nav-default">Markdown基本语法</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  


 
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2017 -
    2019
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        heyb7
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.dee43230127a73d039a734510fa896c89c3c7ce0cf0be0c7a7433f8fd69b76dc.js" integrity="sha256-3uQyMBJ6c9A5pzRRD6iWyJw8fODPC&#43;DHp0M/j9abdtw=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>












</body>
</html>
